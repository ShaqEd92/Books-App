@{
ViewData["Title"] = "Books";
}

<partial name="NavbarPartial">

<div class="mx-auto" id="dashboard" style="width: 95%;">

    @foreach(var book in @ViewBag.AllBooks)
    {
        bool bookRead = false;
        bool onReadList = true;

        <div id="bookCard" class="card">
            <div class="card-body">
                <h5 class="card-title"> <a href="DisplayBook/@book.BookID" style="color: black">@book.Title</a></h5>
                <a href="FilterAuthor/@book.Author">
                    <h6 class="card-subtitle mb-2 text-muted">@book.Author</h6>
                </a>
                <p class="card-text">@book.Description</p>
                <p><a href="FilterGenre/@book.Genre" class="card-link" style="color: rgb(9, 161, 9)">@book.Genre</a></p>
                <p style="display: inline">
                    @if(@ViewBag.ReaderInSession.ReadingList != null)
                    {
                        @foreach(var willRead in @ViewBag.ReaderInSession.ReadingList)
                        {
                            if(@willRead.BookID == @book.BookID)
                            {
                                onReadList = false;
                            }
                        }        
                    }  

                    @if(@ViewBag.ReaderInSession.BooksRead != null)
                    {
                        @foreach(var readAlready in @ViewBag.ReaderInSession.BooksRead)
                        {
                            if(@readAlready.BookID == @book.BookID)
                            {
                                bookRead = true;
                            }
                        }  
                    }
                    
                    @if(onReadList == true && bookRead == false)
                    {   
                        <form action="WillRead/@book.BookID" method="post" style="display: inline">
                            <input type="hidden" name="@book.BookID">
                            <button data-toggle="popover" title="Add to 'Books to Read' List"><img src="~/books.png"></button>
                        </form>
                    }

                    @if(bookRead == false)
                    {
                        <form action="DidRead/@book.BookID" method="post" style="display: inline">
                            <input type="hidden" name="@book.BookID">
                            <button data-toggle="popoverTwo" title="Mark Book as 'Read'"><img src="~/checked.png"></button>
                            &nbsp;
                        </form>
                    }

                    @if(book.ReaderID == ViewBag.ReaderID)
                    {
                        <a href="Edit/@book.BookID" style="display: inline" data-toggle="popoverThree" title="Edit Book"><img src="~/edit.png"></a>
                        
                        <form action="Delete/@book.BookID" method="post" style="display: inline">
                            <input type="hidden" name="@book.BookID">
                            &nbsp;
                            <button onclick="deleteButton()" id="deleteBook" data-toggle="popoverFour" title="Delete Book"><img src="~/clear.png" ></button>
                        </form>
                    }
                </p>
            </div>
        </div>
    }

</div>

<script type="text/javascript">

    $(document).ready(function () {
        $('[data-toggle="popover"]').popover();
    });


    $(document).ready(function () {
        $('[data-toggle="popover"]').popoverTwo();
    });


    $(document).ready(function () {
        $('[data-toggle="popover"]').popoverThree();
    });


    $(document).ready(function () {
        $('[data-toggle="popover"]').popoverFour();
    });


    function deleteButton() {
        var x = confirm("Are you sure you want to delete this book?");
        if (x == false) {
            $(document).ready(function () {
                $("deleteBook").click(function (event) {
                    event.preventDefault();
                })
            })
        }
    };

</script>


<!-- <div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a
        href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>

<div>Icons made by <a href="https://www.flaticon.com/authors/maxim-basinski" title="Maxim Basinski">Maxim Basinski</a>
    from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>

<div>Icons made by <a href="https://www.flaticon.com/authors/smashicons" title="Smashicons">Smashicons</a> from <a
        href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>

<div>Icons made by <a href="https://www.flaticon.com/authors/pixelmeetup" title="Pixelmeetup">Pixelmeetup</a> from <a
        href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->